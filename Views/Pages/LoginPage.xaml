<?xml version="1.0" encoding="utf-8" ?>
<local:DisposableContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:FlockForge.ViewModels.Pages"
             xmlns:local="clr-namespace:FlockForge.Views.Base"
             x:Class="FlockForge.Views.Pages.LoginPage"
             x:DataType="vm:LoginViewModel"
             Title="Sign In">

    <Grid Style="{StaticResource GF.Grid}">
        <ScrollView>
            <VerticalStackLayout Spacing="{DynamicResource GF.Spacing}" Padding="0" VerticalOptions="Center">

                <!-- Logo/Image -->
                <Image Source="flockforge_logo.png" HeightRequest="120" HorizontalOptions="Center" />

                <Label Text="Welcome to FlockForge"
                       FontSize="28"
                       Style="{StaticResource GF.LabelBase}"
                       HorizontalOptions="Center" />

                <Label Text="Sign in to continue"
                       FontSize="16"
                       TextColor="Gray"
                       Style="{StaticResource GF.LabelBase}"
                       HorizontalOptions="Center" />

                <!-- Email Entry -->
                <Entry x:Name="EmailEntry"
                       Style="{StaticResource GF.Entry}"
                       Text="{Binding Email}"
                       Placeholder="Email"
                       Keyboard="Email"
                       SemanticProperties.Description="Enter your email address" />

                <!-- Password Entry -->
                <Entry x:Name="PasswordEntry"
                       Style="{StaticResource GF.Entry}"
                       Text="{Binding Password}"
                       Placeholder="Password"
                       IsPassword="True"
                       SemanticProperties.Description="Enter your password" />

                <!-- Error message label -->
                <Label Text="{Binding ErrorMessage}"
                       TextColor="Red"
                       IsVisible="{Binding HasError}"
                       HorizontalOptions="Center" />

                <!-- Sign In Button -->
                <Button Text="Sign In"
                        Style="{StaticResource GF.ButtonBase}"
                        Command="{Binding LoginCommand}"
                        SemanticProperties.Description="Submit sign in form" />

                <!-- Google Sign In -->
                <Button Text="Sign in with Google"
                        Style="{StaticResource GF.ButtonBase}"
                        Command="{Binding LoginWithGoogleCommand}"
                        SemanticProperties.Description="Sign in using Google account" />

                <!-- Links -->
                <Label HorizontalOptions="Center">
                    <Label.FormattedText>
                        <FormattedString>
                            <Span Text="Don't have an account? " TextColor="Gray" />
                            <Span Text="Register" TextColor="#5B4CF5" TextDecorations="Underline">
                                <Span.GestureRecognizers>
                                    <TapGestureRecognizer Command="{Binding RegisterCommand}" />
                                </Span.GestureRecognizers>
                            </Span>
                        </FormattedString>
                    </Label.FormattedText>
                </Label>

                <!-- Forgot Password Link -->
                <Label HorizontalOptions="Center" Margin="0,10,0,0">
                    <Label.FormattedText>
                        <FormattedString>
                            <Span Text="Forgot Password?" TextColor="#5B4CF5" TextDecorations="Underline">
                                <Span.GestureRecognizers>
                                    <TapGestureRecognizer Command="{Binding ResetPasswordCommand}" />
                                </Span.GestureRecognizers>
                            </Span>
                        </FormattedString>
                    </Label.FormattedText>
                </Label>

                <!-- Busy Indicator -->
                <StackLayout
                    IsVisible="{Binding IsBusy}"
                    Orientation="Horizontal"
                    HorizontalOptions="Center"
                    Spacing="10">
                    <ActivityIndicator
                        IsRunning="{Binding IsBusy}"
                        Color="#5B4CF5"/>
                    <Label Text="{Binding BusyMessage}"
                       IsVisible="{Binding IsBusy}"
                       HorizontalOptions="Center" />
                </StackLayout>

            </VerticalStackLayout>
        </ScrollView>
    </Grid>
</local:DisposableContentPage>